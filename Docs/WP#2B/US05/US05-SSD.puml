@startuml
title US05 - SSD - Register a Patient with Photo and Health Concerns
actor "Anonymous User"
participant "System"

"Anonymous User" -> "System" : POST /api/v2/patients/register\nBody: FullPatientDTO

alt dataConsentGiven == false
  "System" --> "Anonymous User" : 400 Bad Request\n"Data consent is required"
else
  alt email already exists
    "System" --> "Anonymous User" : 409 Conflict\n"Email already in use"
  else
    alt missing mandatory data
      "System" --> "Anonymous User" : 400 Bad Request\n"Missing required data"
    else
      alt invalid health concern (e.g. ongoing == false\nbut no resolvedDate)
        "System" --> "Anonymous User" : 400 Bad Request\n"Invalid health concern data"
      else
        "System" --> "Anonymous User" : 201 Created\nBody: { patientId, message }
      end
    end
  end
end
@enduml
