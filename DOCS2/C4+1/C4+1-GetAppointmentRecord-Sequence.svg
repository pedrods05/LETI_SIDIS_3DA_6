<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="2106.25px" preserveAspectRatio="none" style="width:2743px;height:2106px;background:#FFFFFF;" version="1.1" viewBox="0 0 2743 2106" width="2743.75px" zoomAndPan="magnify"><title>C4: Sequence Diagram - Get Appointment Record</title><defs/><g><text fill="#000000" font-family="Arial" font-size="21.875" font-weight="bold" lengthAdjust="spacing" textLength="516.5726" x="1123.2784" y="43.2404">C4: Sequence Diagram - Get Appointment Record</text><g><title>Client</title><rect fill="#FFFFFF" height="1768.6157" style="stroke:#181818;stroke-width:1.5625;" width="15.625" x="102.9633" y="198.877"/></g><g><title>Spring Security</title><rect fill="#FFFFFF" height="81.3232" style="stroke:#181818;stroke-width:1.5625;" width="15.625" x="433.4854" y="298.2056"/></g><g><title>AppointmentRecordController</title><rect fill="#FFFFFF" height="215.4785" style="stroke:#181818;stroke-width:1.5625;" width="15.625" x="847.1024" y="253.6377"/></g><g><title>AppointmentRecordController</title><rect fill="#FFFFFF" height="1385.8032" style="stroke:#181818;stroke-width:1.5625;" width="15.625" x="847.1024" y="581.6895"/></g><g><title>AppointmentRecordService</title><rect fill="#FFFFFF" height="369.8608" style="stroke:#181818;stroke-width:1.5625;" width="15.625" x="1323.1644" y="634.0698"/></g><g><title>hap-physicians API</title><rect fill="#FFFFFF" height="44.5679" style="stroke:#181818;stroke-width:1.5625;" width="15.625" x="2180.6152" y="878.0396"/></g><g><title>Peer AppointmentRecordController</title><rect fill="#FFFFFF" height="81.3232" style="stroke:#181818;stroke-width:1.5625;" width="15.625" x="2481.9664" y="1323.0591"/></g><rect fill="none" height="204.541" style="stroke:#000000;stroke-width:2.3438;" width="963.0608" x="62.5" y="321.6431"/><rect fill="none" height="816.1621" style="stroke:#000000;stroke-width:2.3438;" width="2702.1919" x="31.25" y="1138.8306"/><rect fill="none" height="455.957" style="stroke:#000000;stroke-width:2.3438;" width="2670.9419" x="46.875" y="1242.4805"/><rect fill="none" height="296.4355" style="stroke:#000000;stroke-width:2.3438;" width="2639.6919" x="62.5" y="1346.4966"/><rect fill="none" height="159.6069" style="stroke:#000000;stroke-width:2.3438;" width="2002.298" x="684.269" y="1472.3877"/><g><title>Client</title><rect fill="#000000" fill-opacity="0.00000" height="1798.3032" width="12.5" x="104.5258" y="183.252"/><line style="stroke:#181818;stroke-width:0.7813;stroke-dasharray:7.8125,7.8125;" x1="109.375" x2="109.375" y1="183.252" y2="1981.5552"/></g><g><title>Spring Security</title><rect fill="#000000" fill-opacity="0.00000" height="1798.3032" width="12.5" x="435.0479" y="183.252"/><line style="stroke:#181818;stroke-width:0.7813;stroke-dasharray:7.8125,7.8125;" x1="440.5708" x2="440.5708" y1="183.252" y2="1981.5552"/></g><g><title>AppointmentRecordController</title><rect fill="#000000" fill-opacity="0.00000" height="1798.3032" width="12.5" x="848.6649" y="183.252"/><line style="stroke:#181818;stroke-width:0.7813;stroke-dasharray:7.8125,7.8125;" x1="854.5815" x2="854.5815" y1="183.252" y2="1981.5552"/></g><g><title>AppointmentRecordService</title><rect fill="#000000" fill-opacity="0.00000" height="1798.3032" width="12.5" x="1324.7269" y="183.252"/><line style="stroke:#181818;stroke-width:0.7813;stroke-dasharray:7.8125,7.8125;" x1="1330.6488" x2="1330.6488" y1="183.252" y2="1981.5552"/></g><g><title>MongoDB .Projection Read Model.</title><rect fill="#000000" fill-opacity="0.00000" height="1798.3032" width="12.5" x="1881.4407" y="183.252"/><line style="stroke:#181818;stroke-width:0.7813;stroke-dasharray:7.8125,7.8125;" x1="1886.8294" x2="1886.8294" y1="183.252" y2="1981.5552"/></g><g><title>hap-physicians API</title><rect fill="#000000" fill-opacity="0.00000" height="1798.3032" width="12.5" x="2182.1777" y="183.252"/><line style="stroke:#181818;stroke-width:0.7813;stroke-dasharray:7.8125,7.8125;" x1="2186.9896" x2="2186.9896" y1="183.252" y2="1981.5552"/></g><g><title>Peer AppointmentRecordController</title><rect fill="#000000" fill-opacity="0.00000" height="1798.3032" width="12.5" x="2483.5289" y="183.252"/><line style="stroke:#181818;stroke-width:0.7813;stroke-dasharray:7.8125,7.8125;" x1="2488.3034" x2="2488.3034" y1="183.252" y2="1981.5552"/></g><g class="participant participant-head" data-participant="C"><text fill="#000000" font-family="Arial" font-size="21.875" lengthAdjust="spacing" textLength="55.9265" x="78.125" y="178.6163">Client</text><ellipse cx="110.7758" cy="78.3447" fill="#E2E2F0" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.7813;"/><path d="M110.7758,90.8447 L110.7758,133.0322 M90.4633,103.3447 L131.0883,103.3447 M110.7758,133.0322 L90.4633,156.4697 M110.7758,133.0322 L131.0883,156.4697" fill="none" style="stroke:#181818;stroke-width:0.7813;"/></g><g class="participant participant-tail" data-participant="C"><text fill="#000000" font-family="Arial" font-size="21.875" lengthAdjust="spacing" textLength="55.9265" x="78.125" y="1999.7955">Client</text><ellipse cx="110.7758" cy="2017.7124" fill="#E2E2F0" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.7813;"/><path d="M110.7758,2030.2124 L110.7758,2072.3999 M90.4633,2042.7124 L131.0883,2042.7124 M110.7758,2072.3999 L90.4633,2095.8374 M110.7758,2072.3999 L131.0883,2095.8374" fill="none" style="stroke:#181818;stroke-width:0.7813;"/></g><g class="participant participant-head" data-participant="SEC"><rect fill="#E2E2F0" height="46.3135" rx="3.9063" ry="3.9063" style="stroke:#181818;stroke-width:0.7813;" width="170.2042" x="356.1958" y="135.376"/><text fill="#000000" font-family="Arial" font-size="21.875" lengthAdjust="spacing" textLength="148.3292" x="367.1333" y="166.1163">Spring Security</text></g><g class="participant participant-tail" data-participant="SEC"><rect fill="#E2E2F0" height="46.3135" rx="3.9063" ry="3.9063" style="stroke:#181818;stroke-width:0.7813;" width="170.2042" x="356.1958" y="1979.9927"/><text fill="#000000" font-family="Arial" font-size="21.875" lengthAdjust="spacing" textLength="148.3292" x="367.1333" y="2010.733">Spring Security</text></g><g class="participant participant-head" data-participant="ARC"><rect fill="#E2E2F0" height="46.3135" rx="3.9063" ry="3.9063" style="stroke:#181818;stroke-width:0.7813;" width="310.0418" x="699.894" y="135.376"/><text fill="#000000" font-family="Arial" font-size="21.875" lengthAdjust="spacing" textLength="288.1668" x="710.8315" y="166.1163">AppointmentRecordController</text></g><g class="participant participant-tail" data-participant="ARC"><rect fill="#E2E2F0" height="46.3135" rx="3.9063" ry="3.9063" style="stroke:#181818;stroke-width:0.7813;" width="310.0418" x="699.894" y="1979.9927"/><text fill="#000000" font-family="Arial" font-size="21.875" lengthAdjust="spacing" textLength="288.1668" x="710.8315" y="2010.733">AppointmentRecordController</text></g><g class="participant participant-head" data-participant="ARS"><rect fill="#E2E2F0" height="46.3135" rx="3.9063" ry="3.9063" style="stroke:#181818;stroke-width:0.7813;" width="288.1561" x="1186.8988" y="135.376"/><text fill="#000000" font-family="Arial" font-size="21.875" lengthAdjust="spacing" textLength="266.2811" x="1197.8363" y="166.1163">AppointmentRecordService</text></g><g class="participant participant-tail" data-participant="ARS"><rect fill="#E2E2F0" height="46.3135" rx="3.9063" ry="3.9063" style="stroke:#181818;stroke-width:0.7813;" width="288.1561" x="1186.8988" y="1979.9927"/><text fill="#000000" font-family="Arial" font-size="21.875" lengthAdjust="spacing" textLength="266.2811" x="1197.8363" y="2010.733">AppointmentRecordService</text></g><g class="participant participant-head" data-participant="MONGO_R"><rect fill="#E2E2F0" height="46.3135" rx="3.9063" ry="3.9063" style="stroke:#181818;stroke-width:0.7813;" width="361.0977" x="1707.1419" y="135.376"/><text fill="#000000" font-family="Arial" font-size="21.875" lengthAdjust="spacing" textLength="339.2227" x="1718.0794" y="166.1163">MongoDB (Projection Read Model)</text></g><g class="participant participant-tail" data-participant="MONGO_R"><rect fill="#E2E2F0" height="46.3135" rx="3.9063" ry="3.9063" style="stroke:#181818;stroke-width:0.7813;" width="361.0977" x="1707.1419" y="1979.9927"/><text fill="#000000" font-family="Arial" font-size="21.875" lengthAdjust="spacing" textLength="339.2227" x="1718.0794" y="2010.733">MongoDB (Projection Read Model)</text></g><g class="participant participant-head" data-participant="HPHY"><rect fill="#E2E2F0" height="46.3135" rx="3.9063" ry="3.9063" style="stroke:#181818;stroke-width:0.7813;" width="209.1263" x="2083.8646" y="135.376"/><text fill="#000000" font-family="Arial" font-size="21.875" lengthAdjust="spacing" textLength="187.2513" x="2094.8021" y="166.1163">hap-physicians API</text></g><g class="participant participant-tail" data-participant="HPHY"><rect fill="#E2E2F0" height="46.3135" rx="3.9063" ry="3.9063" style="stroke:#181818;stroke-width:0.7813;" width="209.1263" x="2083.8646" y="1979.9927"/><text fill="#000000" font-family="Arial" font-size="21.875" lengthAdjust="spacing" textLength="187.2513" x="2094.8021" y="2010.733">hap-physicians API</text></g><g class="participant participant-head" data-participant="ARC_PEER"><rect fill="#E2E2F0" height="46.3135" rx="3.9063" ry="3.9063" style="stroke:#181818;stroke-width:0.7813;" width="362.326" x="2308.6159" y="135.376"/><text fill="#000000" font-family="Arial" font-size="21.875" lengthAdjust="spacing" textLength="340.451" x="2319.5534" y="166.1163">Peer AppointmentRecordController</text></g><g class="participant participant-tail" data-participant="ARC_PEER"><rect fill="#E2E2F0" height="46.3135" rx="3.9063" ry="3.9063" style="stroke:#181818;stroke-width:0.7813;" width="362.326" x="2308.6159" y="1979.9927"/><text fill="#000000" font-family="Arial" font-size="21.875" lengthAdjust="spacing" textLength="340.451" x="2319.5534" y="2010.733">Peer AppointmentRecordController</text></g><g><title>Client</title><rect fill="#FFFFFF" height="1768.6157" style="stroke:#181818;stroke-width:1.5625;" width="15.625" x="102.9633" y="198.877"/></g><g><title>Spring Security</title><rect fill="#FFFFFF" height="81.3232" style="stroke:#181818;stroke-width:1.5625;" width="15.625" x="433.4854" y="298.2056"/></g><g><title>AppointmentRecordController</title><rect fill="#FFFFFF" height="215.4785" style="stroke:#181818;stroke-width:1.5625;" width="15.625" x="847.1024" y="253.6377"/></g><g><title>AppointmentRecordController</title><rect fill="#FFFFFF" height="1385.8032" style="stroke:#181818;stroke-width:1.5625;" width="15.625" x="847.1024" y="581.6895"/></g><g><title>AppointmentRecordService</title><rect fill="#FFFFFF" height="369.8608" style="stroke:#181818;stroke-width:1.5625;" width="15.625" x="1323.1644" y="634.0698"/></g><g><title>hap-physicians API</title><rect fill="#FFFFFF" height="44.5679" style="stroke:#181818;stroke-width:1.5625;" width="15.625" x="2180.6152" y="878.0396"/></g><g><title>Peer AppointmentRecordController</title><rect fill="#FFFFFF" height="81.3232" style="stroke:#181818;stroke-width:1.5625;" width="15.625" x="2481.9664" y="1323.0591"/></g><g class="message" data-participant-1="C" data-participant-2="ARC"><polygon fill="#181818" points="828.3524,247.3877,843.9774,253.6377,828.3524,259.8877,834.6024,253.6377" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;" x1="118.5883" x2="837.7274" y1="253.6377" y2="253.6377"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="11.2968" x="129.5258" y="234.8618">1</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="365.8134" x="147.0726" y="223.5153">GET /api/appointment-records/{recordId}</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="339.7781" x="147.0726" y="246.2082">Authorization, X-User-Id, X-User-Role</text></g><g class="message" data-participant-1="ARC" data-participant-2="SEC"><polygon fill="#181818" points="466.2979,291.9556,450.6729,298.2056,466.2979,304.4556,460.0479,298.2056" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;" x1="456.9229" x2="845.5399" y1="298.2056" y2="298.2056"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="11.2968" x="475.6729" y="290.7761">2</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="350.7576" x="493.2198" y="290.7761">hasAnyAuthority('ADMIN','PATIENT') ?</text></g><path d="M62.5,321.6431 L156.517,321.6431 L156.517,331.8359 L140.892,347.4609 L62.5,347.4609 L62.5,321.6431" fill="#EEEEEE" style="stroke:#000000;stroke-width:2.3438;"/><rect fill="none" height="204.541" style="stroke:#000000;stroke-width:2.3438;" width="963.0608" x="62.5" y="321.6431"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="23.7045" x="85.9375" y="341.5939">alt</text><text fill="#000000" font-family="Arial" font-size="17.1875" font-weight="bold" lengthAdjust="spacing" textLength="101.1948" x="179.9545" y="340.3275">[Authorized]</text><g class="message" data-participant-1="SEC" data-participant-2="ARC"><polygon fill="#181818" points="828.3524,373.2788,843.9774,379.5288,828.3524,385.7788,834.6024,379.5288" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="441.2979" x2="837.7274" y1="379.5288" y2="379.5288"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="11.2968" x="452.2354" y="372.0993">3</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="46.2883" x="469.7823" y="372.0993">allow</text></g><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="62.5" x2="1025.5608" y1="393.5913" y2="393.5913"/><text fill="#000000" font-family="Arial" font-size="17.1875" font-weight="bold" lengthAdjust="spacing" textLength="131.7513" x="70.3125" y="409.1507">[Not authorized]</text><g class="message" data-participant-1="SEC" data-participant-2="C"><polygon fill="#181818" points="135.7758,462.8662,120.1508,469.1162,135.7758,475.3662,129.5258,469.1162" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="126.4008" x2="439.7354" y1="469.1162" y2="469.1162"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="11.2968" x="145.1508" y="450.3403">4</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="267.6628" x="162.6976" y="438.9938">403 Forbidden + {"error": "..."}</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="151.2627" x="162.6976" y="461.6867">(Spring Security)</text></g><g class="message" data-participant-1="C" data-participant-2="SEC"><polygon fill="#181818" points="422.5479,507.4341,438.1729,513.6841,422.5479,519.9341,428.7979,513.6841" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="118.5883" x2="431.9229" y1="513.6841" y2="513.6841"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="11.2968" x="129.5258" y="506.2546">5</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="5.6435" x="147.0726" y="506.2546">&#160;</text></g><g class="message" data-participant-1="ARC" data-participant-2="ARC"><line style="stroke:#181818;stroke-width:1.5625;" x1="854.9149" x2="928.3524" y1="561.377" y2="561.377"/><line style="stroke:#181818;stroke-width:1.5625;" x1="928.3524" x2="928.3524" y1="561.377" y2="581.6895"/><line style="stroke:#181818;stroke-width:1.5625;" x1="864.2899" x2="928.3524" y1="581.6895" y2="581.6895"/><polygon fill="#181818" points="879.9149,575.4395,864.2899,581.6895,879.9149,587.9395,873.6649,581.6895" style="stroke:#181818;stroke-width:1.5625;"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="11.2968" x="873.6649" y="553.9474">6</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="431.1844" x="891.2117" y="553.9474">build UserDTO(id=X-User-Id, role=X-User-Role)</text></g><g class="message" data-participant-1="ARC" data-participant-2="ARS"><polygon fill="#181818" points="1304.4144,627.8198,1320.0394,634.0698,1304.4144,640.3198,1310.6644,634.0698" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;" x1="862.7274" x2="1313.7894" y1="634.0698" y2="634.0698"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="11.2968" x="873.6649" y="626.6403">7</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="413.2027" x="891.2117" y="626.6403">getAppointmentRecord(recordId, currentUser)</text></g><g class="message" data-participant-1="ARS" data-participant-2="MONGO_R"><polygon fill="#181818" points="1868.9407,672.3877,1884.5657,678.6377,1868.9407,684.8877,1875.1907,678.6377" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;" x1="1338.7894" x2="1878.3157" y1="678.6377" y2="678.6377"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="11.2968" x="1349.7269" y="671.2082">8</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="161.4388" x="1367.2737" y="671.2082">findById(recordId)</text></g><g class="message" data-participant-1="MONGO_R" data-participant-2="ARS"><polygon fill="#181818" points="1355.9769,716.9556,1340.3519,723.2056,1355.9769,729.4556,1349.7269,723.2056" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="1346.6019" x2="1886.1282" y1="723.2056" y2="723.2056"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="11.2968" x="1365.3519" y="715.7761">9</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="375.6226" x="1382.8987" y="715.7761">AppointmentRecordProjection | NotFound</text></g><g class="message" data-participant-1="ARS" data-participant-2="ARS"><line style="stroke:#181818;stroke-width:1.5625;" x1="1338.7894" x2="1404.4144" y1="790.4663" y2="790.4663"/><line style="stroke:#181818;stroke-width:1.5625;" x1="1404.4144" x2="1404.4144" y1="790.4663" y2="810.7788"/><line style="stroke:#181818;stroke-width:1.5625;" x1="1340.3519" x2="1404.4144" y1="810.7788" y2="810.7788"/><polygon fill="#181818" points="1355.9769,804.5288,1340.3519,810.7788,1355.9769,817.0288,1349.7269,810.7788" style="stroke:#181818;stroke-width:1.5625;"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="22.5937" x="1349.7269" y="771.6904">10</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="474.7452" x="1378.5706" y="760.3439">if PATIENT and projection.patientId != currentUser.id</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="310.5194" x="1378.5706" y="783.0368">then throw UnauthorizedException</text></g><g class="message" data-participant-1="ARS" data-participant-2="HPHY"><polygon fill="#181818" points="2161.8652,871.7896,2177.4902,878.0396,2161.8652,884.2896,2168.1152,878.0396" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;" x1="1338.7894" x2="2171.2402" y1="878.0396" y2="878.0396"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="22.5937" x="1349.7269" y="859.2636">11</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="268.7141" x="1378.5706" y="847.9172">GET /physicians/{physicianId}</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="213.3606" x="1378.5706" y="870.61">(enrich physicianName)</text></g><g class="message" data-participant-1="HPHY" data-participant-2="ARS"><polygon fill="#181818" points="1355.9769,916.3574,1340.3519,922.6074,1355.9769,928.8574,1349.7269,922.6074" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="1346.6019" x2="2186.8652" y1="922.6074" y2="922.6074"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="22.5937" x="1365.3519" y="915.1779">12</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="225.7881" x="1394.1956" y="915.1779">200 OK / errors (ignored)</text></g><g class="message" data-participant-1="ARS" data-participant-2="ARC"><polygon fill="#181818" points="879.9149,997.6807,864.2899,1003.9307,879.9149,1010.1807,873.6649,1003.9307" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="870.5399" x2="1329.4144" y1="1003.9307" y2="1003.9307"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="22.5937" x="889.2899" y="996.5012">13</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="266.433" x="918.1335" y="996.5012">AppointmentRecordViewDTO</text></g><g class="message" data-participant-1="ARC" data-participant-2="C"><polygon fill="#181818" points="135.7758,1042.2485,120.1508,1048.4985,135.7758,1054.7485,129.5258,1048.4985" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="126.4008" x2="845.5399" y1="1048.4985" y2="1048.4985"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="22.5937" x="145.1508" y="1041.069">14</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="358.4641" x="173.9944" y="1041.069">200 OK + AppointmentRecordViewDTO</text></g><g class="message" data-participant-1="ARS" data-participant-2="ARC"><polygon fill="#181818" points="879.9149,1109.1431,864.2899,1115.3931,879.9149,1121.6431,873.6649,1115.3931" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="870.5399" x2="1329.4144" y1="1115.3931" y2="1115.3931"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="22.5937" x="889.2899" y="1107.9636">15</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="285.6247" x="918.1335" y="1107.9636">throw NotFoundException(msg)</text></g><path d="M31.25,1138.8306 L125.267,1138.8306 L125.267,1149.0234 L109.642,1164.6484 L31.25,1164.6484 L31.25,1138.8306" fill="#EEEEEE" style="stroke:#000000;stroke-width:2.3438;"/><rect fill="none" height="816.1621" style="stroke:#000000;stroke-width:2.3438;" width="2702.1919" x="31.25" y="1138.8306"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="23.7045" x="54.6875" y="1158.7814">alt</text><text fill="#000000" font-family="Arial" font-size="17.1875" font-weight="bold" lengthAdjust="spacing" textLength="263.662" x="148.7045" y="1157.515">[Request tem "X-Peer-Request"]</text><g class="message" data-participant-1="ARC" data-participant-2="C"><polygon fill="#181818" points="135.7758,1190.4663,120.1508,1196.7163,135.7758,1202.9663,129.5258,1196.7163" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="126.4008" x2="845.5399" y1="1196.7163" y2="1196.7163"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="22.5937" x="145.1508" y="1189.2868">16</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="278.067" x="173.9944" y="1189.2868">404 Not Found + {"error": msg}</text></g><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="31.25" x2="2733.4419" y1="1210.7788" y2="1210.7788"/><text fill="#000000" font-family="Arial" font-size="17.1875" font-weight="bold" lengthAdjust="spacing" textLength="320.52" x="39.0625" y="1226.3382">[Sem "X-Peer-Request" -&gt; tentar peers]</text><path d="M46.875,1242.4805 L160.054,1242.4805 L160.054,1252.6733 L144.429,1268.2983 L46.875,1268.2983 L46.875,1242.4805" fill="#EEEEEE" style="stroke:#000000;stroke-width:2.3438;"/><rect fill="none" height="455.957" style="stroke:#000000;stroke-width:2.3438;" width="2670.9419" x="46.875" y="1242.4805"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="42.8665" x="70.3125" y="1262.4313">loop</text><text fill="#000000" font-family="Arial" font-size="17.1875" font-weight="bold" lengthAdjust="spacing" textLength="456.6185" x="183.4915" y="1261.1649">[para cada peer em ExternalServiceClient.getPeerUrls()]</text><g class="message" data-participant-1="ARC" data-participant-2="ARC_PEER"><polygon fill="#181818" points="2463.2164,1316.8091,2478.8414,1323.0591,2463.2164,1329.3091,2469.4664,1323.0591" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;" x1="862.7274" x2="2472.5914" y1="1323.0591" y2="1323.0591"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="22.5937" x="873.6649" y="1304.2831">17</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="424.4896" x="902.5085" y="1292.9367">HTTP GET /api/appointment-records/{recordId}</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="594.3489" x="902.5085" y="1315.6296">(fwd Authorization, X-User-Id, X-User-Role, X-Peer-Request=true)</text></g><path d="M62.5,1346.4966 L156.517,1346.4966 L156.517,1356.6895 L140.892,1372.3145 L62.5,1372.3145 L62.5,1346.4966" fill="#EEEEEE" style="stroke:#000000;stroke-width:2.3438;"/><rect fill="none" height="296.4355" style="stroke:#000000;stroke-width:2.3438;" width="2639.6919" x="62.5" y="1346.4966"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="23.7045" x="85.9375" y="1366.4474">alt</text><text fill="#000000" font-family="Arial" font-size="17.1875" font-weight="bold" lengthAdjust="spacing" textLength="161.4098" x="179.9545" y="1365.181">[Peer tem o registo]</text><g class="message" data-participant-1="ARC_PEER" data-participant-2="ARC"><polygon fill="#181818" points="879.9149,1398.1323,864.2899,1404.3823,879.9149,1410.6323,873.6649,1404.3823" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="870.5399" x2="2488.2164" y1="1404.3823" y2="1404.3823"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="22.5937" x="889.2899" y="1396.9528">18</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="358.4641" x="918.1335" y="1396.9528">200 OK + AppointmentRecordViewDTO</text></g><g class="message" data-participant-1="ARC" data-participant-2="C"><polygon fill="#181818" points="135.7758,1442.7002,120.1508,1448.9502,135.7758,1455.2002,129.5258,1448.9502" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="126.4008" x2="845.5399" y1="1448.9502" y2="1448.9502"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="22.5937" x="145.1508" y="1441.5207">19</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="358.4641" x="173.9944" y="1441.5207">200 OK + AppointmentRecordViewDTO</text></g><path d="M684.269,1472.3877 L808.7845,1472.3877 L808.7845,1482.5806 L793.1595,1498.2056 L684.269,1498.2056 L684.269,1472.3877" fill="#EEEEEE" style="stroke:#000000;stroke-width:2.3438;"/><rect fill="none" height="159.6069" style="stroke:#000000;stroke-width:2.3438;" width="2002.298" x="684.269" y="1472.3877"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="54.203" x="707.7065" y="1492.3386">break</text><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="684.269" x2="2686.5669" y1="1499.7681" y2="1499.7681"/><text fill="#000000" font-family="Arial" font-size="17.1875" font-weight="bold" lengthAdjust="spacing" textLength="164.3051" x="692.0815" y="1515.3275">[Peer responde 404]</text><g class="message" data-participant-1="ARC_PEER" data-participant-2="ARC"><polygon fill="#181818" points="879.9149,1546.3501,864.2899,1552.6001,879.9149,1558.8501,873.6649,1552.6001" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="870.5399" x2="2488.2164" y1="1552.6001" y2="1552.6001"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="22.5937" x="889.2899" y="1545.1706">20</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="134.3819" x="918.1335" y="1545.1706">404 Not Found</text></g><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="684.269" x2="2686.5669" y1="1566.6626" y2="1566.6626"/><text fill="#000000" font-family="Arial" font-size="17.1875" font-weight="bold" lengthAdjust="spacing" textLength="198.6633" x="692.0815" y="1582.222">[Peer erro (timeout/5xx)]</text><g class="message" data-participant-1="ARC_PEER" data-participant-2="ARC"><polygon fill="#181818" points="879.9149,1613.2446,864.2899,1619.4946,879.9149,1625.7446,873.6649,1619.4946" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="870.5399" x2="2488.2164" y1="1619.4946" y2="1619.4946"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="22.5937" x="889.2899" y="1612.0651">21</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="129.8195" x="918.1335" y="1612.0651">error (ignored)</text></g><g class="message" data-participant-1="ARC" data-participant-2="C"><polygon fill="#181818" points="135.7758,1679.6875,120.1508,1685.9375,135.7758,1692.1875,129.5258,1685.9375" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="126.4008" x2="845.5399" y1="1685.9375" y2="1685.9375"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="22.5937" x="145.1508" y="1678.508">22</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="278.067" x="173.9944" y="1678.508">404 Not Found + {"error": msg}</text></g><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="31.25" x2="2733.4419" y1="1710.9375" y2="1710.9375"/><text fill="#000000" font-family="Arial" font-size="17.1875" font-weight="bold" lengthAdjust="spacing" textLength="203.3882" x="39.0625" y="1726.4969">[UnauthorizedException]</text><g class="message" data-participant-1="ARS" data-participant-2="ARC"><polygon fill="#181818" points="879.9149,1757.5195,864.2899,1763.7695,879.9149,1770.0195,873.6649,1763.7695" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="870.5399" x2="1329.4144" y1="1763.7695" y2="1763.7695"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="22.5937" x="889.2899" y="1756.34">23</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="317.244" x="918.1335" y="1756.34">throw UnauthorizedException(msg)</text></g><g class="message" data-participant-1="ARC" data-participant-2="C"><polygon fill="#181818" points="135.7758,1802.0874,120.1508,1808.3374,135.7758,1814.5874,129.5258,1808.3374" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="126.4008" x2="845.5399" y1="1808.3374" y2="1808.3374"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="22.5937" x="145.1508" y="1800.9079">24</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="274.6849" x="173.9944" y="1800.9079">403 Forbidden + {"error": msg}</text></g><line style="stroke:#000000;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="31.25" x2="2733.4419" y1="1822.3999" y2="1822.3999"/><text fill="#000000" font-family="Arial" font-size="17.1875" font-weight="bold" lengthAdjust="spacing" textLength="195.7848" x="39.0625" y="1837.9593">[Unexpected Exception]</text><g class="message" data-participant-1="ARS" data-participant-2="ARC"><polygon fill="#181818" points="879.9149,1868.9819,864.2899,1875.2319,879.9149,1881.4819,873.6649,1875.2319" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="870.5399" x2="1329.4144" y1="1875.2319" y2="1875.2319"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="22.5937" x="889.2899" y="1867.8024">25</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="169.3436" x="918.1335" y="1867.8024">throw Exception(e)</text></g><g class="message" data-participant-1="ARC" data-participant-2="C"><polygon fill="#181818" points="135.7758,1936.2427,120.1508,1942.4927,135.7758,1948.7427,129.5258,1942.4927" style="stroke:#181818;stroke-width:1.5625;"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:3.125,3.125;" x1="126.4008" x2="845.5399" y1="1942.4927" y2="1942.4927"/><text fill="#000000" font-family="Arial" font-size="20.3125" font-weight="bold" lengthAdjust="spacing" textLength="22.5937" x="145.1508" y="1923.7167">26</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="223.5367" x="173.9944" y="1912.3703">500 Internal Server Error</text><text fill="#000000" font-family="Arial" font-size="20.3125" lengthAdjust="spacing" textLength="477.5818" x="173.9944" y="1935.0632">+ {"error": "External service communication error: ..."}</text></g><!--SRC=[hLPhRkCs4FwlKqpzevQGoCcsoPy0sS99dAnHn3PYfzW20HQCDBRObKYLecAdwG8zHE_G0_G8UvEUf4FgwKSswIE04OcQnpSptyom2-T7Us_Whzz-XolKq4zJoOLEK6YumK2g45mMyuN049PSHn3843qd-yX5oXHB84mvl3a-R9ra4Glbaei5p5cSOUlB1SvP7kjBAVI89GXznLdiE9hh60d62Kpnvnn5W731sS9e-C-0SXmMQAcWSnvpEkq0o-3S8I-Q1pnb9DUPfifWc6AGAwuVhSXqi27KibmOFYTiIiOnAglGltb9OOhgWGTOIa_NfQ-bMCYBCt0dIlw4WUPIK00iX6lAOknPfUlnw6hyuMPTCMAfdqQF6HqmGOOdGolxRlBkntN12QA2LqJnOJ8Ot53MSYr5djoZCWda3qnJufqk-FH7o2ZxcOQlwwJ1bH4m7vrpyDyQGt02LuCP7B2Kqw_swolhE3juAXw6uQSxqSzr91N_XPd0z-6zVvkXyeTX_NWZOso0c6GR3-I82aME8fRrnMDfHJ-wtVx5zN3KtUzE-hFXO3JhUl1TeswAos9YI-aLGmUi8Rz6pk9OBkaqn3Kj99h2I6fWkrIDuj7Xjt0frJqFGnIm1qyTL4ggpWbqUhrUXs9rD_ZcRRjPEp310YZKkH8E2c9qMOMpdCSXa15bw9vJcee2b9af0hctGYQ75xEnoyFJLcwfy7ZQIh1NcsveONDSCBUmlgi8H6TojK2znI-tAl9-1THuyzfMfhLNjtJa5THFcrROgnFEodSKYWUHRVGowAb1KlO8ePbp4Puz3Xi4dbDzz6l8MtXRxVUhAVIbp2dZfV52Xy-XP1KmqKRPImaSMHg6yDLfEzmU3- -4ZeWFEb9o2RUYeSzW5M1gj4qMnlQ9nUte7ZY3LeDdHOegIARFgqPhf0wUwcVRNcvXhx5ZXcgh27PQM5DDQhuvF8Jnzt00bhyPk3JQfK9AOukRLh4gtpZNWKmmWr1MC25XAPLIPf1YB6abDBIoN8hhtJ6tYGRhl6d3hVhym759HDxiaAdLRBgm1B_tl86gass1co9i0YWAjYNd9jd2smP19sKk-a9pFvOoXKNEA3mRBa0HS34yDIRGUU-RkUoNPnqIMG_awF38pXlhVcsS489F96xZcEumPTYXAMocAFUeCckw2nE5PiKg2DWzVlw3nH4LHo7jKfPmOHPoTWAl6iVcfUtnLAiShHSRj_52Ja9ctGCX7AmqAc9tsUN5GkxHr31MRbMSkPvLBpFmjjv6b8TtizdazUl4dI_3_n141QCzwegrM9vJ5UqwDIMKbBq5pxGiFq83kw7HotoibDS7VzlhFsLufNMla7qitonRB7I5MIf5Y8PXNqA-Hi1NeUpQDkSYPmK7KlNvpnLFfEN15Wv3Pt0rJr3c-k1ujVA-XCQIlpMA_ZSyPMpL_owCK4HvKd0tn0SPFs0EMHvWbib_qQLcRTkWTy_-ZMM_QmRjL7nc3csYU-vAOj5Lk72LqXwZs_jBqx3nZY_wFYQQ3aNHz_OUGUaS6EztOkrkLCs6Ud7G9abomODYtrkv4x0tA7i7-Xi0]--></g></svg>